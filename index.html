<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <title>Emergency Location Background</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" ></script>
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <style>
    img#image, div#qrcode {
      display: none;
    }
    canvas#canvas {
        width: 100%;
    }
    </style>
</head>

<body>

<script type="text/javascript">
// <![CDATA[
var qrcodesize=350;
var qrcodeborder=40;
var targetx=1920;
var targety=1080;

function onUpload() {
	  let fileObj = document.getElementById('fileupload');
    let file, filename="-";
    if (fileObj.files) {
        file = fileObj.files[0]
    		console.log("1");
        filename = file.name;
        var fr = new FileReader;
        fr.onloadend = displayImg;
        fr.readAsDataURL(file);
    } else {
        file = fileObj.value;
        displayImg(file);
    };
    // https://davidshimjs.github.io/qrcodejs/
    var qrcontent = document.getElementById("qrcontent").value;
    new QRCode(document.getElementById("qrcode"), { 
                text: qrcontent, 
                width: qrcodesize, height: qrcodesize, 
                correctLevel : QRCode.CorrectLevel.H
            });
};
function displayImg(file) {
    if(typeof file === "object") {
        file = file.target.result; // file reader
    }
    document.getElementById("image").setAttribute("src",file);
    let ctx = document.getElementById("canvas").getContext("2d");
    var background = new Image();
    background.src = file; 
    background.addEventListener('load', function() {
        ctx.drawImage(background,0,0,targetx,targety);
        ctx.fillStyle = '#FFFFFF';
        ctx.fillRect((targetx/2-qrcodesize/2-qrcodeborder), targety-(qrcodesize+qrcodeborder*2), qrcodesize+qrcodeborder*2, qrcodesize+qrcodeborder*2);
        ctx.font = '48px sans-serif';
        
        ctx.save();
        ctx.fillStyle = '#FF0000';
        ctx.translate(targetx/2-qrcodesize/2-qrcodeborder-qrcodeborder/3, targety-qrcodesize/2-qrcodeborder);
        ctx.rotate(-Math.PI/2);
        ctx.textAlign = "center";
        ctx.strokeStyle = 'white';

        ctx.miterLimit = 2;
        ctx.lineJoin = 'circle';

        // draw an outline, then filled
        ctx.lineWidth = 17;
        ctx.strokeText("Emergency Location", 0, 0);
        ctx.lineWidth = 1;

        ctx.fillText("Emergency Location", 0, 0);
        ctx.restore();
        
        var qrcode = document.querySelector("#qrcode img");
        ctx.drawImage(qrcode,(targetx/2-qrcodesize/2),targety-qrcodesize-qrcodeborder);

    }, false);

}
function download() {
        var link = document.createElement('a');
        link.download = 'filename.png';
        link.href = document.getElementById('canvas').toDataURL()
        link.click();
    }
// ]]>
</script>


  <main>
    <div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-light">
      <div class="col-md-12 p-lg-1 mx-auto my-1">
        <h1 class="display-4 fw-normal">Notfall QR-Code</h1>
        <p class="lead fw-normal">Hast Du auch so viele Video Konferenzen?<br />
            Nat√ºrlich. Denn seit wir durch die Pandemie bedingt alle im Home-Office sitzen, h√§ngen wir alle in Video-Konferenzen üòê<br />
            Hast Du Dir schon mal Gedanken gemacht, was passieren w√ºrde, wenn einer der Teilnehmer aufeinmal z.B. einen Schlaganfall bekommt und umf√§llt?<br />
            Der Notfall-QR-Code k√∂nnte eine L√∂sung sein!<br />

        </p>
      </div>
    </div>
    <div class="container px-4">
        <div class="row">
            <div class="col-md-12">
                <br /><br />
                <h2>Wie funktioniert das?</h2>
                </div>
        </div>
    </div>
    <div class="container px-4">
        <div class="row">
            <div class="col-md-4"><br /><br />
                Wie nutzen fast alle virtuelle Hintergr√ºnde in den Videokonferenzen.
                Mit unserem K√∂rper verdecken wir den mittleren Teil des Hintergrundes.
            </div>
            <div class="col-md-4"><br /><br />
                Im medizinischen Notfall, wenn jemand vor dem Bildschirm umkippt, wird der komplette Hintergrund sichtbar.
                Die Idee ist nun, in diesem Bereich Notfallinformationen zu hinterlegen, wie z.B. eine Adresse.
            </div>
            <div class="col-md-4"><br /><br />
                Mit einem QR-Code ist die Information nicht sofort lesbar, solltest Du mal kurz aufstehen.
                F√ºr maximalen Datenschutz solltest Du Deine Kamera aber ausschalten, wenn Du aus dem Bild gehst.
            </div>

        </div>
    </div>
    <div class="container px-4">
        <div class="row">
            <div class="col-md-12">
                <br /><br /><br />
                <h2>3 Schritte zum Ziel</h2>
                </div>
        </div>
    </div>
    <div class="container px-4">
        <div class="row">
            <div class="col-md-4">
                <p>
        <h3>Schritt 1</h3>
        Welche Information soll in dem QR-Code versteckt werden?
        Sinnvoll k√∂nnte z.B. die Adresse sein, an der Du bist.
        Gehe z.B. auf <a href="https://maps.google.com" target="_new">Google Maps</a> und w√§hle die Adresse an der Du arbeitest.
        Klicke auf das Teilen-Symbol und kopiere den Link in folgendes Feld:<br /><br />
        <input type="text" name="qrcontent" id="qrcontent" style="width: 100%;"/>
        </p>
    </div>
        <div class="col-md-4">
        <p>
            <h3>Schritt 2</h3>
            W√§hle von Deinem Rechner das Hintergrundbild, auf das Du den QR-Code gesetzt haben m√∂chtest.<br />
            Achte auf das Seitenverh√§ltnis Deines Bildes. Idealer Weise sollte es 1920x1080 Pixel gro√ü sein.<br /><br /><br />
            <input type="file" id="fileupload" onchange="onUpload();" /></li>
        </p>
    </div>
    <div class="col-md-4">
        <p>
            <h3>Schritt 3</h3>
            Klicke auf das Bild um es zu speichern:<br />
            <canvas id="canvas" width="1920" height="1080" name="test.png" onclick="download();"></canvas>
            <div id="qrcode"></div>
            <img id="image" src="" alt="" />
        </p>
    </div>
    <div class="container px-4">
        <div class="row">
            <div class="col-md-12">
                <small>Hinweis:<br />
                    Wenn Du Google-Maps nutzt, dann landen Deine Daten nat√ºrlich bei Google.<br />
                    Dein Hintergrundbild bleibt allerdings allein auf Deinem System und wird nur in den Browser geladen.</small>
                </div>
        </div>
    </div>
</div>
</div>
</div>
</main>

<!--footer class="container py-5">
  <div class="row">
    <div class="col-6 col-md">
      <h5>Github</h5>
    </div>
  </div>
</footer-->
</body>
</html>
